dynamic_predicate(bought,2).
dynamic_predicate(played1,2).
dynamic_predicate(played2,2).
dynamic_predicate(played3,2).
dynamic_predicate(sold,2).
dynamic_predicate(happy,2).


tabled_predicate(plan,0).
tabled_predicate(action,0).
tabled_predicate(buy,2).
tabled_predicate(play1,2).
tabled_predicate(play2,2).
tabled_predicate(play3,2).
tabled_predicate(playhappily,2).
tabled_predicate(sell,2).

% Actions
% tr_clause(+Head,+Body)



tr_clause(
	buy(X,M),
		ins(bought(X,M))).
tr_clause(
	play1(X,M),
		seq(bought(X,M),
		seq(not(played1(X,M)),
		ins(played1(X,M))))).
tr_clause(
	playhappily(X,M),
		seq(bought(X,M),
		seq(not(played1(X,M)),
		seq(ins(played1(X,M)),
		ins(happy(X,M)))))).
tr_clause(
	play2(X,M),
		seq(played1(X,M),
		seq(not(played2(X,M)),
		ins(played2(X,M))))).
tr_clause(
	play3(X,M),
		seq(played2(X,M),
		seq(not(played3(X,M)),
		ins(played3(X,M))))).
tr_clause(
	sell(X,M),
		seq(played1(X,M),
		seq(not(played3(X,M)),
		seq(not(happy(X,M)),
		ins(sold(X,M)))))).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% plan %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


tr_clause(
	plan,
		seq(action,
		plan)).
tr_clause(
	plan,
		true).
tr_clause(
	action,
		buy(_,_)).
tr_clause(
	action,
		play1(_,_)).
tr_clause(
	action,
		playhappily(_,_)).
tr_clause(
	action,
		play2(_,_)).
tr_clause(
	action,
		play3(_,_)).
tr_clause(
	action,
		sell(_,_)).


